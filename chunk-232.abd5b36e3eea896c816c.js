"use strict";(self.webpackChunkhopital_availabilty_frontend=self.webpackChunkhopital_availabilty_frontend||[]).push([[232],{16601:function(e,t,n){var r=n(64836),a=n(18698);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(56690)),s=r(n(89728)),o=r(n(66115)),l=r(n(41588)),c=r(n(61655)),u=r(n(94993)),f=r(n(73808)),d=r(n(38416)),p=n(23624),h=r(n(44634)),m=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=x(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(n(67294)),v=n(85893);function x(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(x=function(e){return e?n:t})(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,d.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(e){(0,c.default)(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,f.default)(t);if(n){var a=(0,f.default)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,u.default)(this,e)});function a(e){var t;return(0,i.default)(this,a),t=r.call(this,e),(0,d.default)((0,o.default)(t),"element",(0,m.createRef)()),(0,d.default)((0,o.default)(t),"aTag",(0,m.createRef)()),t.state=y({},t.state),t}return(0,s.default)(a,[{key:"componentDidMount",value:function(){var e=this;(0,l.default)((0,f.default)(a.prototype),"componentDidMount",this).call(this),this.observer=new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){if(e.element.current)if(e.props.attachment){var n;"src"in e.element.current&&(e.element.current.src=null===(n=e.props)||void 0===n?void 0:n.attachment)}else"innerHTML"in e.element.current&&(e.element.current.innerHTML=e.props.content);e.observer=void 0}}))}),{rootMargin:"500px 0px 200px 0px",root:document.querySelector(".chat-main")}),this.observer.observe(this.element.current)}},{key:"render",value:function(){var e,t;return(0,v.jsx)(v.Fragment,{children:this.props.content?(0,v.jsx)("div",{ref:this.element,className:"chat-message"}):null!==(e=this.props.mime)&&void 0!==e&&e.startsWith("image")?(0,v.jsx)("img",{ref:this.element,style:y(y({borderRadius:"25px"},this.props.border),{},{width:"100%",marginLeft:"0",marginRight:"0"}),alt:"download"}):null!==(t=this.props.mime)&&void 0!==t&&t.startsWith("video")?(0,v.jsx)("video",{ref:this.element,style:y(y({borderRadius:"25px"},this.props.border),{},{width:"100%",marginLeft:"0",marginRight:"0"}),controls:!0}):(0,v.jsxs)("object",{type:this.props.mime,style:y(y({borderRadius:"25px"},this.props.border),{},{width:"100%",marginLeft:"0",marginRight:"0"}),className:"invisible-scroll-bar",width:"100%",height:"100%",children:[(0,v.jsx)("embed",{ref:this.element,type:this.props.mime,className:"invisible-scroll-bar",style:y(y({borderRadius:"25px"},this.props.border),{},{width:"100%",marginLeft:"0",marginRight:"0"}),width:"100%",height:"100%"}),(0,v.jsx)("div",{className:"d-flex justify-content-center",children:(0,v.jsxs)("a",{style:y(y({},this.props.messageStyle),{},{position:"relative"}),href:"#",ref:this.aTag,download:(new Date).toString(),children:[" ",(0,v.jsx)(h.default,{sx:y(y({},this.props.messageStyle),{},{fontSize:"2rem"})}),"Download"]})})]})})}}]),a}(p.AuthComponent);t.default=j},75232:function(e,t,n){var r=n(64836),a=n(18698);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(64687)),s=r(n(17156)),o=r(n(56690)),l=r(n(89728)),c=r(n(66115)),u=r(n(41588)),f=r(n(61655)),d=r(n(94993)),p=r(n(73808)),h=r(n(38416)),m=n(23624),v=n(5977),x=r(n(8703)),g=n(73727),y=r(n(87153)),j=r(n(39341)),b=r(n(69956)),w=r(n(74113)),k=r(n(22624)),O=r(n(87418)),P=r(n(74900)),R=r(n(30642)),S=r(n(26307));n(20722);var M=r(n(40055)),C=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=U(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(n(67294)),D=r(n(69483)),F=r(n(89589)),B=r(n(28598)),L=r(n(98372)),_=r(n(89376)),I=r(n(76093)),N=r(n(94964)),E=r(n(2138)),T=r(n(44634)),W=r(n(16601)),z=n(85893);function U(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(U=function(e){return e?n:t})(e)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,h.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K={sent:{background:"#385FF6",color:"#F7F7F7"},received:{background:"#F7F7F7",color:"#1B1A57"}},q=function(e){(0,f.default)(m,e);var t,n,r,a=(n=m,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,p.default)(n);if(r){var a=(0,p.default)(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return(0,d.default)(this,e)});function m(e){var t,n,r,l;(0,o.default)(this,m),l=a.call(this,e),(0,h.default)((0,c.default)(l),"messagesEndRef",(0,C.createRef)()),(0,h.default)((0,c.default)(l),"fileInput",(0,C.createRef)()),(0,h.default)((0,c.default)(l),"imageInput",(0,C.createRef)()),(0,h.default)((0,c.default)(l),"attachButton",(0,C.createRef)()),(0,h.default)((0,c.default)(l),"onMessage",(function(e){return l.setState({messages:e},(function(){return l.scrollToBottom()}))})),(0,h.default)((0,c.default)(l),"scrollToBottom",(function(){var e;return null===(e=l.messagesEndRef.current)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})})),(0,h.default)((0,c.default)(l),"resetState",(function(e){"Escape"===e.key&&l.setState({showPicker:!1,filePopover:!1})})),(0,h.default)((0,c.default)(l),"sendMessage",(0,s.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.state.chat){e.next=3;break}return e.next=3,null===(t=l.state.connection)||void 0===t?void 0:t.sendMessage(l.state.chat,l.state.mime);case 3:l.setState({chat:"",mime:void 0,filePopover:!1});case 4:case"end":return e.stop()}}),e)})))),(0,h.default)((0,c.default)(l),"sendFile",(0,s.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.state.fileContent){e.next=3;break}return e.next=3,null===(t=l.state.connection)||void 0===t?void 0:t.sendMessage(l.state.fileContent,l.state.mime);case 3:l.setState({fileContent:void 0,mime:void 0,filePopover:!1});case 4:case"end":return e.stop()}}),e)})))),(0,h.default)((0,c.default)(l),"uploadFile",function(){var e=(0,s.default)(i.default.mark((function e(t){var n,r,a,s,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new FileReader,a=new Promise((function(e,t){r.onloadend=e,r.onerror=t})),!(s=null===(n=t.target.files)||void 0===n?void 0:n[0])){e.next=10;break}return r.readAsDataURL(s),e.next=7,a;case 7:return l.setState({mime:(null==s?void 0:s.type)||"application/octet-stream",fileContent:null===(o=r.result)||void 0===o?void 0:o.toString()}),e.next=10,l.sendFile();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,h.default)((0,c.default)(l),"handleInputChange",function(){var e=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key||t.shiftKey){e.next=4;break}return e.abrupt("return",l.sendMessage());case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var u=null===(t=l.state.user)||void 0===t||null===(n=t.chat_friends)||void 0===n?void 0:n.find((function(e){return e.token===l.props.match.params.chatId}));return u&&null!==(r=l.state.user)&&void 0!==r&&r.tokens.private_token?l.state=H(H({},l.state),{},{chat:"",chatUser:u,messages:[],showPicker:!1,filePopover:!1}):l.props.history.replace("/chat"),l}return(0,l.default)(m,[{key:"componentDidMount",value:(t=(0,s.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,u.default)((0,p.default)(m.prototype),"componentDidMount",this).call(this),this.state.auth&&null!==(t=this.state.user)&&void 0!==t&&null!==(n=t.tokens)&&void 0!==n&&n.private_token){e.next=3;break}return e.abrupt("return",this.performAuth());case 3:return e.t0=this,e.next=6,D.default.getItem("messages-".concat(this.state.chatUser.token));case 6:if(e.t1=e.sent,e.t1){e.next=9;break}e.t1=[];case 9:e.t2=e.t1,e.t0.onMessage.call(e.t0,e.t2),this.setState({connection:new x.default(this.state.user.tokens.private_token,this.state.chatUser.token,this.onMessage)}),document.addEventListener("keydown",this.resetState,!1);case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){(0,u.default)((0,p.default)(m.prototype),"componentWillUnmount",this).call(this),this.state.connection.tareDown()}},{key:"render",value:function(){var e=this;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{style:{height:"91vh"},children:[(0,z.jsxs)("div",{className:"d-flex px-3 align-items-center top-nav-chat",children:[(0,z.jsx)(g.Link,{style:{textDecoration:"none"},to:"/chat",children:(0,z.jsx)(y.default,{sx:{color:"#4F5E7B"}})}),(0,z.jsx)("img",{style:{borderRadius:"50%",marginLeft:"1rem"},src:j.default,alt:""}),(0,z.jsxs)("div",{style:{marginLeft:"1rem",paddingTop:"1rem"},className:"d-flex flex-column text-start",children:[(0,z.jsx)("div",{className:"h5 m-0 fw-bold",children:this.state.chatUser.name}),(0,z.jsxs)("div",{children:["Last seen on ",this.state.chatUser.last_seen]})]}),(0,z.jsx)(g.Link,{style:{textDecoration:"none"},to:"/video_call/".concat(this.state.chatUser.token),children:(0,z.jsx)(b.default,{sx:{marginLeft:"auto",marginRight:"1rem"},color:"action"})})]}),(0,z.jsxs)("div",{className:"chat-main",children:[(0,z.jsx)("p",{style:{margin:".5rem",fontSize:"10px",color:"#A1A1BC"},children:"Message Now"}),this.state.messages.map((function(t,n){var r=t.content,a=t.type,i=t.time,s=t.attachment,o=t.mime,l=e.state.messages[n+1],c=e.state.messages[n-1],u=(null==c?void 0:c.type)===a?"8px":"25px",f=(null==l?void 0:l.type)===a?"8px":"25px";console.log(o);var d="sent"!==a?{borderTopLeftRadius:u,borderBottomLeftRadius:f}:{borderTopRightRadius:u,borderBottomRightRadius:f};s?d.position="relative":(d.padding=".25rem",d.paddingLeft="1rem",d.paddingRight="1rem",d.paddingTop=".5rem");var p=r?{display:"flex",alignSelf:"end"}:{display:"flex",alignSelf:"end",position:"absolute",bottom:"4px",right:"4px",opacity:"1"};return(0,z.jsx)("div",{ref:e.messagesEndRef,className:"d-flex align-items-center mb-1 mx-2 ".concat((null==c?void 0:c.type)!==a?"mt-4":"mt-0"," ").concat("sent"===a?"justify-content-end":"justify-content-start"),children:(0,z.jsxs)("div",{style:H(H({},K[a]),d),className:"d-flex flex-column message-bubble ",children:[(0,z.jsx)(W.default,{content:r,messageStyle:K[a],attachment:s,border:d,mime:o}),(0,z.jsxs)("div",{className:"ms-1",style:p,children:[(0,z.jsx)("p",{style:{marginBottom:"0",fontSize:"8px",marginLeft:"auto"},children:i}),"sent"===a&&(0,z.jsx)(M.default,{sx:{height:"12px"}})]})]})},n)}))]})]}),(0,z.jsxs)("div",{className:"bottom-texting-bar d-flex flex-column align-items-center w-100",children:[(0,z.jsxs)("div",{className:"d-flex align-items-center flex-row",children:[(0,z.jsx)(w.default,{sx:{p:"10px"},"aria-label":"menu",children:(0,z.jsx)(k.default,{onClick:function(){e.setState({showPicker:!e.state.showPicker})}})}),(0,z.jsx)(O.default,{sx:{ml:1,flex:1},value:this.state.chat,placeholder:"Write a message...",multiline:!0,onKeyDown:function(t){return e.handleInputChange(t)},onChange:function(t){return e.setState({chat:t.target.value})}}),(0,z.jsxs)("div",{children:[(0,z.jsx)(w.default,{sx:{p:"10px"},onClick:function(){return e.setState({filePopover:!e.state.filePopover})},ref:this.attachButton,children:(0,z.jsx)(P.default,{})}),(0,z.jsx)(B.default,{className:"d-flex justify-content-center align-items-center",style:{zIndex:1e3,width:"100vw"},open:this.state.filePopover,anchorEl:this.attachButton.current,transition:!0,children:function(t){var n=t.TransitionProps;return(0,z.jsx)(L.default,H(H({style:{width:"95vw",height:"6rem"}},n),{},{timeout:150,children:(0,z.jsxs)(_.default,{className:"d-flex align-items-center justify-content-around mb-3",children:[(0,z.jsxs)(F.default,{sx:{p:2},children:[(0,z.jsx)(T.default,{sx:{color:"#5157ae",fontSize:"2rem"},onClick:function(){var t;return null===(t=e.fileInput.current)||void 0===t?void 0:t.click()}}),(0,z.jsx)("p",{style:{fontSize:"13px",marginBottom:"0"},children:"Document"})]}),(0,z.jsxs)(F.default,{sx:{p:2},children:[(0,z.jsx)(I.default,{sx:{color:"#b462cf",fontSize:"2rem"},onClick:function(){var t;return null===(t=e.imageInput.current)||void 0===t?void 0:t.click()}}),(0,z.jsx)("p",{style:{fontSize:"13px",marginBottom:"0"},children:"Media"})]}),(0,z.jsxs)(F.default,{sx:{p:2},children:[(0,z.jsx)(N.default,{sx:{color:"#d44a6d",fontSize:"2rem"},onClick:function(){var t;return null===(t=e.imageInput.current)||void 0===t?void 0:t.click()}}),(0,z.jsx)("p",{style:{fontSize:"13px",marginBottom:"0"},children:"Camera"})]})]})}))}})]}),(0,z.jsx)(w.default,{onClick:this.sendMessage,sx:{p:"10px",m:"10px",background:"#385FF6",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{backgroundColor:"#385FF6"}},children:this.state.chat?(0,z.jsx)(S.default,{sx:{color:"#fff"}}):(0,z.jsx)(R.default,{sx:{color:"#fff"}})}),(0,z.jsx)("input",{type:"file",hidden:!0,onChange:this.uploadFile,accept:"video/*,image/*",ref:this.imageInput}),(0,z.jsx)("input",{type:"file",hidden:!0,onChange:this.uploadFile,accept:"*",ref:this.fileInput})]}),(0,z.jsx)("div",{style:{bottom:"4rem"},children:this.state.showPicker&&(0,z.jsx)(E.default,{pickerStyle:{width:"100%"},onEmojiClick:function(t,n){return e.setState({chat:e.state.chat+n.emoji})}})})]})]})}}]),m}(m.AuthComponent),V=(0,v.withRouter)(q);t.default=V}}]);
//# sourceMappingURL=chunk-232.abd5b36e3eea896c816c.js.map